<script type="text/x-red" data-template-name="wotkit in">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
    <div id="poll-details" class="form-row">
        <label for="node-input-timeout"><i class="fa fa-clock-o"></i> Poll Every</label>
        <input type="text" id="node-input-timeout" placeholder="Time" style="direction:rtl; width:50px !important">
        <select id="node-input-timeoutUnits" style="width:200px !important">
          <option value="seconds">Seconds</option>
          <option value="minutes">Minutes</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit in">
    <p>Provides an input node for WoTKit, allowing the creation of simple web services.</p>
    <p>The resulting message has the following properties:
        <ul>
            <li>msg.payload : message payload</li>
        </ul>
    </p>
    <p>
       To use this node, correct WoTKit login credentials must be provided to receive sensor data. 
    </p>
    <p>
       WotKit Sensor Name should be in the form of "{username}.{sensor name}"
    </p>
    <p>
       <b>Note: </b>The poll interval will determine how frequent the node retrieves sensor data
    </p>

</script>

<script type="text/x-red" data-template-name="wotkit out">
    <div class="form-row">
        <label for="node-input-twitter"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit out">
    <p>Sends responses back to WoTKit sensor received from an input node.</p>
    <p>The response can be customised using the following message properties:</p>
    <ul>
        <li><code>payload</code> is consists of the sensor fields and values</li>
    </ul>
    <p>
       To use this node, correct WoTKit login credentials must be provided to receive sensor data. 
    </p>
    <p>
       WotKit Sensor Name should be in the form of "{username}.{sensor name}"
    </p>
</script>

<script type="text/x-red" data-template-name="wotkit-credentials">
    <div class="form-row node-input-broker">
        <label for="node-config-input-nickname"><i class="fa fa-globe"></i> Config Name</label>
        <input class="input-append-left" type="text" id="node-config-input-nickname" placeholder="Nickname" >
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
        <input type="password" id="node-config-input-password">
    </div>
</script>


<script type="text/javascript">
    RED.nodes.registerType('wotkit in',{
        category: 'input',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            timeout: {value:"5", required:true, validate:RED.validators.number()},
            timeoutUnits: {value:"seconds",required:true},
            sensor: {value:"",required:true},
            login: {value:"", type:"wotkit-credentials"},
        },
        inputs:0,
        outputs:1,
        icon: "white-globe.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            var root = RED.settings.httpNodeRoot;
            if (root.slice(-1) == "/") {
                root = root.slice(0,-1);
            }
            if (root == "") {
                $("#node-input-tip").hide();
            } else {
                $("#node-input-path").html(root);
                $("#node-input-tip").show();
            }
            $( "#node-input-timeout" ).spinner({min:1,max:60});
            if (!this.timeoutUnits) {
                $("#node-input-timeoutUnits option").filter(function() {
                  return $(this).val() == 'seconds';
                }).attr('selected', true);
            }

        }

    });

    RED.nodes.registerType('wotkit out',{
        category: 'output',
        color:"rgb(231, 231, 174)",
        defaults: {
            name: {value:""},
            sensor: {value:"",required:true},
            login: {value:"", type:"wotkit-credentials"},
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "white-globe.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
        },
    });
    
    RED.nodes.registerType('wotkit-credentials',{
        category: 'config',
        defaults: {
            nickname: {value:"Default"}
        },
        credentials: {
            user: {type: "text"},
            password: {type:"password"}
        },
            
        label: function() {
            return this.nickname;
        }
    });
</script>
