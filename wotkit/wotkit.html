<!-- Node for WoTKit Sensor Input -->

<script type="text/x-red" data-template-name="wotkit in">
    <div class="form-row">
        <label for="node-input-login"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
    <div id="poll-details" class="form-row">
        <label for="node-input-timeout"><i class="fa fa-clock-o"></i> Poll Every</label>
        <input type="text" id="node-input-timeout" placeholder="Time" style="direction:rtl; width:50px !important">
        <select id="node-input-timeoutUnits" style="width:200px !important">
          <option value="seconds">Seconds</option>
          <option value="minutes">Minutes</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit in">

    <p>WoTKit Sensor Input Node</p>

    <p>Retrieves new data from a WoTKit Sensor.  This node retrieves data sent to a WoTKit sensor after this node is deployed.</p>

    <p>The <code>message.payload</code> contains a map of sensor field names to sensor values.
    </p>
    <p>
       To use this node, the WoTKit URL (default is the <a href="http://wotkit.sensetecnic.com">WoTKit sandbox</a>) and login credentials must be provided.  Credentials can be either your WoTKit user name and password, or a key id and password associated with your account.
    </p>
    <p>
       The sensor name should be in the form <code>{username}.{sensorname}</code> or you can use the numeric sensor id.
    </p>
    <p>The poll interval specifies how often this node calls the WoTKit to retrieve new sensor data.  </p>
    <p><strong>Note:</strong>  the first request will occur after the intial poll interval has elapsed, starting with data sent to the sensor after the node was deployed.
    </p>

</script>

<!-- Node for WoTKit Sensor Output -->

<script type="text/x-red" data-template-name="wotkit out">
    <div class="form-row">
        <label for="node-input-login"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit out">

    <p>WoTKit Sensor Output Node</p>

    <p>Sends data to a registered WoTKit sensor. The node will use the <code>message.payload</code> to create a data object.</p>

    <p>The <code>message.payload</code> must contain an Object of key-value pairs matching the sensor fields. For example a sensor with the default fields expects:</p>
    <pre>msg.payload = {
	value:1028,
	lat:123.60,
	lng:49.23,
	message:"Memory Update"
}</pre>

    <p>If receiving a number from another node, for example <code>message.payload = 123456</code> the sensor's <code>value</code> field will be updated using the following object:</p>
    <pre>msg.payload = { value:  123456}</pre>

    <p>If receiving a string from another node, for example <code>message.payload = "Hello World"</code> the sensor's <code>message</code> field will be updated using the following object:</p>
    <pre>msg.payload = { message:  "Hello World"}</pre>

    <p>To use this node, WoTKit login credentials must be provided.  This can be either the user name and password, or a key id and password associated with the account.</p>
    <p>
       The WotKit Sensor Name should be in the form of <code>{username}.{sensorname}</code> or using the numeric sensor id.
    </p>
</script>

<!-- Node for WoTKit Sensor Raw Data Request -->

<script type="text/x-red" data-template-name="wotkit data">
    <div class="form-row">
        <label for="node-input-login"><i class="fa fa-user"></i>Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
    <div id="poll-details" class="form-row">
        <label for="node-input-before"><i class="fa fa-clock-o"></i>Before</label>
        <input type="text" id="node-input-before" placeholder="Before" style="direction:rtl; width:50px !important">
        <select id="node-input-beforeType" style="width:200px !important">
          <option value="elements">Elements</option>
          <option value="seconds">Seconds</option>
        </select>
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit data">

    <p>WoTKit Historical Data Node</p>

    <p>Retrieves historical data from a WoTKit sensor by either number of elements or relative time before the request.</p>

    <p>The <code>message.payload</code> contains a map of sensor field names to sensor values.
    </p>
    <p>
       To use this node, the WoTKit URL (default is the <a href="http://wotkit.sensetecnic.com">WoTKit sandbox</a>) and login credentials must be provided.  Credentials can be either your WoTKit user name and password, or a key id and password associated with your account.
    </p>
    <p>
       The sensor name should be in the form <code>{username}.{sensorname}</code> or you can use the numeric sensor id.
    </p>

    <p>Selecting "Elements" will retrieve the last X number of data elements.</p>
    <p>Selecting "Seconds" will retrieve any data elements created in the last X seconds. For example "10 Seconds" will retrieve all elements created after 10 seconds before the node received an input message.</p>

</script>



<!-- Node for WoTKit Control Output -->

<script type="text/x-red" data-template-name="wotkit control-out">
    <div class="form-row">
        <label for="node-input-login"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit control-out">

    <p>WoTKit Control Output Node</p>

    <p>Provides ability to send events to the control channel of a registered WoTKit sensor. This node will use the <code>message.payload</code> object to create a control event.</p>

    <p>The <code>message.payload</code> must contain an Object of key-value pair for each message. For example, to send a control <code>button: on</code> message:</p>
    <pre>msg.payload = {
	"button":"on"
}</pre>

    <p>If receiving a number from another node, for example <code>message.payload = 123456</code> the following message will be sent:</p>
    <pre>msg.payload = { "slider":  "123456"}</pre>

    <p>If receiving a string from another node, for example <code>message.payload = "Hello World"</code> the following message will be sent:</p>
    <pre>msg.payload = { "message":  "Hello World"}</pre>

    <p>To use this node, WoTKit login credentials must be provided.  This can be either the user name and password, or a key id and password associated with the account.</p>
    <p>
       The WotKit Sensor Name should be in the form of <code>{username}.{sensorname}</code> or using the numeric sensor id.
    </p>


</script>


<!-- Node for WoTKit Control Input -->

<script type="text/x-red" data-template-name="wotkit control-in">
    <div class="form-row">
        <label for="node-input-login"><i class="fa fa-user"></i> Log in as</label>
        <input type="text" id="node-input-login">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-sensor"><i class="icon-tag"></i>Sensor</label>
        <input type="text" id="node-input-sensor" placeholder="Sensor Name">
    </div>
</script>

<script type="text/x-red" data-help-name="wotkit control-in">

    <p>WoTKit Control Input Node</p>

    <p>Provides access to the control channel of a WoTKit sensor. When a control event is received by a WoTKit sensor this node will create a <code>message.payload</code> object containing the event.</p>

    <p>
       To use this node, the WoTKit URL (default is the <a href="http://wotkit.sensetecnic.com">WoTKit sandbox</a>) and login credentials must be provided.  Credentials can be either your WoTKit user name and password, or a key id and password associated with your account.
    </p>
    <p>
       The sensor name should be in the form <code>{username}.{sensorname}</code> or you can use the numeric sensor id.
    </p>
    <p><strong>Note:</strong>  the first request will occur after the intial poll interval has elapsed, starting with data sent to the sensor after the node was deployed.
    </p>

</script>


<!-- Node for WoTKit Credentials -->

<script type="text/x-red" data-template-name="wotkit-credentials">
    <div class="form-row node-input-broker">
        <label for="node-config-input-nickname"><i class="fa fa-globe"></i> Config Name</label>
        <input class="input-append-left" type="text" id="node-config-input-nickname" placeholder="Nickname" >
    </div>
    <div class="form-row">
        <label for="node-config-input-url"><i class="fa fa-user"></i> WoTKit url</label>
        <input type="text" id="node-config-input-url" placeholder="http://wotkit.sensetecnic.com">
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
        <input type="password" id="node-config-input-password">
    </div>
</script>


<script type="text/javascript">

    /*
     * Node for WoTKit Sensor Input
     */

    RED.nodes.registerType('wotkit in',{
        category: 'WoTKit Data',
        color:"rgb(250, 250, 250)",
        defaults: {
            name: {value:""},
            timeout: {value:"5", required:true, validate:RED.validators.number()},
            timeoutUnits: {value:"seconds",required:true},
            sensor: {required:true},
            login: {type:"wotkit-credentials"},
        },
        inputs:0,
        outputs:1,
        icon: "sts.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit in";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }

    });


    /*
     * Node for WoTKit Sensor Output
     */

    RED.nodes.registerType('wotkit out',{
        category: 'WoTKit Data',
        color:"rgb(250, 250, 250)",
        defaults: {
            name: {value:""},
            sensor: {value:"",required:true},
            login: {value:"", type:"wotkit-credentials"},
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "sts.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit out";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
        },
    });



    /*
     * Node for WoTKit Sensor Data Retrieval
     */

    RED.nodes.registerType('wotkit data',{
        category: 'WoTKit Data',
        color:"rgb(250, 250, 250)",
        defaults: {
            name: {value:""},
            before: {value:"10", validate:RED.validators.number()},
            beforeType: {value:"elements"},
            sensor: {value:"",required:true},
            login: {type:"wotkit-credentials"},
        },
        inputs:1,
        outputs:1,
        icon: "sts.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit data";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }

    });



    /*
     * Node for WoTKit Sensor Control Output
     */

    RED.nodes.registerType('wotkit control-out',{
        category: 'WoTKit Control',
        color:"rgb(250, 250, 250)",
        defaults: {
            name: {value:""},
            sensor: {value:"",required:true},
            login: {value:"", type:"wotkit-credentials"},
        },
        inputs:1,
        outputs:0,
        align: "right",
        icon: "sts.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit control";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
        },
    });


    /*
     * Node for WoTKit Sensor Control Input
     */

    RED.nodes.registerType('wotkit control-in',{
        category: 'WoTKit Control',
        color:"rgb(250, 250, 250)",
        defaults: {
            name: {value:""},
            timeout: {value:"10", validate:RED.validators.number()},
            timeoutUnits: {value:"seconds"},
            sensor: {required:true},
            login: {type:"wotkit-credentials"},
        },
        inputs:0,
        outputs:1,
        icon: "sts.png",
        label: function() {
            if (this.name) {
                return this.name;
            } else if (this.sensor) {
                return this.sensor;
            } else {
                return "wotkit control";
            }
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }

    });


    /*
     * Node for WoTKit Sensor Credentials
     */

    RED.nodes.registerType('wotkit-credentials',{
        category: 'config',
        defaults: {
            nickname: {value:"Default", required:true},
            url: {value:"http://wotkit.sensetecnic.com", required:true}
        },
        credentials: {
            user: {type: "text", required:true},
            password: {type:"password", required:true},
        },
        label: function() {
            return this.nickname;
        }
    });
</script>
